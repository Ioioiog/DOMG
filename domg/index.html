<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>DOMG Beat Sync</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.2/lib/anime.min.js"></script>
  <style>
    body {
      margin: 0;
      background: #0a0a0a;
      font-family: 'Poppins', sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      color: #fff;
      flex-direction: column;
    }

    .card {
      background: linear-gradient(135deg, #1a1a1a, #111);
      border-radius: 20px;
      box-shadow: 0 0 30px rgba(249, 168, 37, 0.25);
      padding: 40px 30px;
      width: 350px;
      text-align: center;
      position: relative;
    }

    .card h1 {
      font-family: 'Roboto Mono', monospace;
      font-size: 3.5rem;
      color: #f9a825;
      margin-bottom: 10px;
      transition: transform 0.1s ease;
    }

    .card h2 {
      font-weight: 300;
      color: #ccc;
      font-size: 1rem;
      margin-bottom: 20px;
    }

    .slot-row {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }

    .slot {
      width: 50px;
      height: 70px;
      background: #222;
      border: 2px solid #444;
      font-size: 2rem;
      font-family: 'Roboto Mono', monospace;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      position: relative;
      border-radius: 8px;
    }

    .slot-reel {
      display: flex;
      flex-direction: column;
    }

    .slot-reel span {
      height: 70px;
      line-height: 70px;
      text-align: center;
    }

    .acronym {
      font-size: 0.85rem;
      color: #aaa;
      opacity: 0;
      transition: opacity 0.5s ease;
      min-height: 1.2em;
    }

    .acronym.visible {
      opacity: 1;
    }

    .header-visual {
      width: 100%;
      height: 100px;
      margin-top: 20px;
      opacity: 0.25;
    }

    #soundwave {
      width: 100%;
      height: 100%;
    }

    #soundwave path {
      animation: wave 4s linear infinite alternate;
    }

    @keyframes wave {
      0% {
        d: path("M0 15 Q 5 0, 10 15 T 20 15 Q 25 30, 30 15 T 40 15 Q 45 0, 50 15 T 60 15 Q 65 30, 70 15 T 80 15 Q 85 0, 90 15 T 100 15");
      }
      50% {
        d: path("M0 15 Q 5 30, 10 15 T 20 15 Q 25 0, 30 15 T 40 15 Q 45 30, 50 15 T 60 15 Q 65 0, 70 15 T 80 15 Q 85 30, 90 15 T 100 15");
      }
      100% {
        d: path("M0 15 Q 5 10, 10 15 T 20 15 Q 25 20, 30 15 T 40 15 Q 45 10, 50 15 T 60 15 Q 65 20, 70 15 T 80 15 Q 85 10, 90 15 T 100 15");
      }
    }
  </style>
</head>
<body>

  <div class="card">
    <h1 id="domgTitle">DOMG</h1>
    <h2>Do Music for Good</h2>

    <div class="slot-row" id="slot-row"></div>
    <div class="acronym" id="acronym"></div>

    <div class="header-visual">
      <svg id="soundwave" viewBox="0 0 100 30" preserveAspectRatio="none">
        <path d="M0 15 Q 5 0, 10 15 T 20 15 Q 25 30, 30 15 T 40 15 Q 45 0, 50 15 T 60 15 Q 65 30, 70 15 T 80 15 Q 85 0, 90 15 T 100 15" stroke="#f9a825" fill="none" stroke-width="1.5" />
      </svg>
    </div>
  </div>

  <audio id="music" src="https://cdn.pixabay.com/audio/2022/03/15/audio_1647d4e1e5.mp3" controls autoplay loop style="margin-top:20px;"></audio>

  <script>
    // Slot logic
    const acronymText = document.getElementById('acronym');
    const slotRow = document.getElementById('slot-row');
    const targetLetters = ['D', 'O', 'M', 'G'];
    const slotHeight = 70;
    const reelLength = 10;
    const slotElements = [];

    const acronyms = [
      "Doing Outstanding Music for Good",
      "Defend Originality, Make Good",
      "Do Our Magic Globally",
      "Dream Of Music Globalized"
    ];

    function getRandomChar() {
      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      return chars[Math.floor(Math.random() * chars.length)];
    }

    function createReel(targetLetter) {
      const reel = document.createElement('div');
      reel.className = 'slot-reel';

      for (let i = 0; i < reelLength; i++) {
        const span = document.createElement('span');
        span.textContent = getRandomChar();
        reel.appendChild(span);
      }

      const finalSpan = document.createElement('span');
      finalSpan.textContent = targetLetter;
      reel.appendChild(finalSpan);

      return reel;
    }

    function spinReel(reel, index) {
      const totalSteps = reelLength + 1;
      anime({
        targets: reel,
        translateY: [0, -totalSteps * slotHeight],
        duration: 2000 + index * 400,
        easing: 'easeInOutCubic'
      });
    }

    function spinAll() {
      acronymText.classList.remove('visible');
      acronymText.textContent = '';

      slotElements.forEach((slotObj, index) => {
        slotObj.reel.style.transform = 'translateY(0)';
        spinReel(slotObj.reel, index);
      });

      setTimeout(() => {
        const random = acronyms[Math.floor(Math.random() * acronyms.length)];
        acronymText.textContent = random;
        acronymText.classList.add('visible');
      }, 2500);
    }

    function initSlots() {
      targetLetters.forEach(letter => {
        const slot = document.createElement('div');
        slot.className = 'slot';

        const reel = createReel(letter);
        slot.appendChild(reel);

        slotElements.push({ reel });
        slotRow.appendChild(slot);
      });
    }

    // Music reactive animation
    const title = document.getElementById('domgTitle');
    const audio = document.getElementById('music');

    const context = new AudioContext();
    const src = context.createMediaElementSource(audio);
    const analyser = context.createAnalyser();
    src.connect(analyser);
    analyser.connect(context.destination);
    analyser.fftSize = 256;

    const bufferLength = analyser.frequencyBinCount;
    const dataArray = new Uint8Array(bufferLength);

    function animate() {
      requestAnimationFrame(animate);
      analyser.getByteFrequencyData(dataArray);

      let sum = 0;
      for (let i = 0; i < bufferLength; i++) {
        sum += dataArray[i];
      }
      const volume = sum / bufferLength;
      const scale = 1 + (volume / 256) * 0.5; // subtle scale from 1 to ~1.5

      title.style.transform = `scale(${scale.toFixed(2)})`;
    }

    document.addEventListener('DOMContentLoaded', () => {
      initSlots();
      spinAll();
      setInterval(spinAll, 7000);

      // Unlock audio context on user interaction
      document.body.addEventListener('click', () => {
        if (context.state !== 'running') {
          context.resume().then(() => {
            animate(); // Start animation on first user interaction
          });
        }
      });
    });
  </script>
</body>
</html>
